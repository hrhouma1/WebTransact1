---
# 1 -  Introduction √† JPA
---

**üíÄ Important ! Lecture Obligatoire üíÄ**

üîç Si vous souhaitez approfondir les concepts et avoir une compr√©hension compl√®te, ce document est exhaustif  
üëâ [‚û°Ô∏è ‚û°Ô∏è ‚û°Ô∏è ‚û°Ô∏è SECTION PR√âC√âDENTE - Allez au R√âSUM√â](3.1.CoursPersistanceJPATheorie.md) 

üëâ [‚¨áÔ∏è ‚¨áÔ∏è ‚¨áÔ∏è R√âSUM√â ](#-Les-bases-de-JPA) 

üëâ [‚¨áÔ∏è ‚¨áÔ∏è ‚¨áÔ∏è EXERCICE 2 ](3.3.Application-Pratique2-Exercice2.md) 

- **JPA (Java Persistence API)** est une sp√©cification Java qui simplifie la gestion des donn√©es relationnelles dans les applications Java.
- Il permet de mapper des objets Java (entit√©s) √† des tables de base de donn√©es relationnelles.

### Les bases de JPA
1. **Entit√©s JPA** : Ce sont des classes Java qui repr√©sentent les objets que vous souhaitez stocker dans la base de donn√©es. Une entit√© est d√©finie par l'annotation `@Entity`.
   - **Exemple** :
     ```java
     @Entity
     public class Customer {
         @Id
         @GeneratedValue(strategy = GenerationType.IDENTITY)
         private Long id;
         private String name;
         // Getters et setters...
     }
     ```

2. **Cl√© primaire** : Chaque entit√© doit avoir une cl√© primaire, souvent annot√©e avec `@Id`. Vous pouvez utiliser `@GeneratedValue` pour indiquer que cette cl√© est g√©n√©r√©e automatiquement.

3. **Relations entre entit√©s** : Les entit√©s peuvent √™tre li√©es entre elles, par exemple :
   - `@OneToMany` pour une relation un-√†-plusieurs.
   - `@ManyToOne` pour une relation plusieurs-√†-un.
   - **Exemple** :
     ```java
     @OneToMany(mappedBy = "customer")
     private List<Order> orders;
     ```

### Installation et Configuration
- Ajoutez les d√©pendances JPA et la base de donn√©es dans votre fichier `pom.xml` (si vous utilisez Maven).
- Configurez la connexion √† la base de donn√©es dans un fichier de configuration comme `application.properties`.

### Gestion des Transactions
- Les transactions permettent de regrouper plusieurs op√©rations en une seule unit√© de travail, assurant que toutes les op√©rations r√©ussissent ou √©chouent ensemble.
- **@Transactional** est une annotation qui g√®re automatiquement les transactions.

### Requ√™tes avec JPA
- **JPQL** (Java Persistence Query Language) est utilis√© pour √©crire des requ√™tes orient√©es objet.
- **Exemple de requ√™te** :
  ```java
  String jpql = "SELECT c FROM Customer c WHERE c.name = :name";
  ```

---
# 2 - TR√àS IMPORTANT - √âtapes pour bien configurer JPA
---

| √âtape | Description | Exemple / Code |
|-------|-------------|----------------|
| 1. Ajouter les d√©pendances dans `pom.xml` | Vous devez inclure les d√©pendances n√©cessaires pour Spring Boot, JPA, et la base de donn√©es (par exemple, PostgreSQL). | [Voir le code en annexe](#annexe-1) |
| 2. Configurer le fichier `application.properties` | Vous devez configurer les propri√©t√©s de la base de donn√©es et d'autres configurations Spring Boot dans le fichier `application.properties`. | [Voir le code en annexe](#annexe-2) |
| 3. Ajouter les annotations n√©cessaires | Vous devez annoter vos classes avec les annotations Spring et JPA, comme `@Entity`, `@Id`, `@GeneratedValue`, etc. | [Voir le code en annexe](#annexe-3) |
| 4. Cr√©er les classes de service et de contr√¥leur | Vous devez impl√©menter la logique m√©tier dans une classe de service et g√©rer les requ√™tes HTTP dans un contr√¥leur. | [Voir le code en annexe](#annexe-4) |

# Annexes

---------
# Annexe 1 
---------
## D√©pendances dans `pom.xml`

```xml
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-jpa</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    <dependency>
        <groupId>org.postgresql</groupId>
        <artifactId>postgresql</artifactId>
        <scope>runtime</scope>
    </dependency>
</dependencies>
```

---------
# Annexe 2 
---------
## Configuration du fichier `application.properties`

```properties
spring.datasource.url=jdbc:postgresql://localhost:5432/nom_base
spring.datasource.username=utilisateur
spring.datasource.password=mot_de_passe
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
```

---------
# Annexe 3
---------

## Annotations pour les classes

```java
@Entity
public class Utilisateur {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String nom;
    private String email;
    // Getters et setters
}
```

---------
# Annexe 4
---------

## Classes de service et de contr√¥leur

```java
@Service
public class UtilisateurService {
    @Autowired
    private UtilisateurRepository utilisateurRepository;

    public List<Utilisateur> getTousLesUtilisateurs() {
        return utilisateurRepository.findAll();
    }
}

@RestController
@RequestMapping("/api/utilisateurs")
public class UtilisateurController {
    @Autowired
    private UtilisateurService utilisateurService;

    @GetMapping
    public List<Utilisateur> getTousLesUtilisateurs() {
        return utilisateurService.getTousLesUtilisateurs();
    }
}
```

