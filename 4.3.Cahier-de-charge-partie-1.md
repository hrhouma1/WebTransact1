--------------------------------
# 1 - Rappel des deux classes **Customer** et **Card** avec les relations de clé primaire (PK) et clé étrangère (FK) :
--------------------------------


```
+--------------------------+             +--------------------------+
|        Customer           |             |          Card             |
+--------------------------+             +--------------------------+
| - customerId (PK)         | <-----------| - cardId (PK)             |
| - customerFirstName       |             | - customerId (FK)         |
| - customerLastName        |             | - cardNumber              |
+--------------------------+             | - cardType                |
                                          | - totalLimit              |
                                          | - amountUsed              |
                                          | - availableAmount         |
                                          | - createDt                |
                                          +--------------------------+
```

- **Customer** : La classe `Customer` contient `customerId` comme clé primaire (PK).
- **Card** : La classe `Card` contient `cardId` comme clé primaire (PK) et `customerId` comme clé étrangère (FK) qui fait référence à `Customer`.

- Relation entre un client et ses cartes, où un client peut avoir plusieurs cartes.


-------------------------------------------------
# 2 - Contraintes d'intégrité :
-------------------------------------------------



# Opérations CRUD pour Customer

| Opération | Point de terminaison | Contrainte | Corps de requête | Auto-incrément | Description |
|-----------|----------------------|------------|------------------|----------------|-------------|
| Create | POST /customers/add | N/A | Oui | ✓ | Ajoute un nouveau client |
| Read (Single) | GET /customers/{id} | ID valide | Non | N/A | Récupère les détails d'un client |
| Read (All) | GET /customers | N/A | Non | N/A | Récupère tous les clients |
| Update | PUT /customers/update/{id} | ID valide | Oui | N/A | Met à jour les informations d'un client |
| Delete (Single) | DELETE /customers/delete/{id} | Pas de cartes associées | Non | N/A | Supprime un client sans cartes |
| Delete (All) | DELETE /customers | N/A | Non | N/A | Supprime tous les clients |

### Exemples de corps de requête pour Customer

**Create Customer**
```json
{
  "customerFirstName": "John",
  "customerLastName": "Doe"
}
```

**Update Customer**
```json
{
  "customerFirstName": "Jane",
  "customerLastName": "Smith"
}
```

# Opérations CRUD pour Card

| Opération | Point de terminaison | Contrainte | Corps de requête | Auto-incrément | Description |
|-----------|----------------------|------------|------------------|----------------|-------------|
| Create | POST /cards/add | Client existant | Oui | ✓ | Ajoute une nouvelle carte |
| Read (Single by ID) | GET /cards/{id} | ID valide | Non | N/A | Récupère les détails d'une carte par ID |
| Read (Single by Number) | GET /cards/number/{cardNumber} | Numéro de carte valide | Non | N/A | Récupère les détails d'une carte par numéro |
| Read (All) | GET /cards | N/A | Non | N/A | Récupère toutes les cartes |
| Update | PUT /cards/update/{id} | ID valide, client existant | Oui | N/A | Met à jour les détails d'une carte |
| Delete (Single by ID) | DELETE /cards/delete/{id} | ID valide | Non | N/A | Supprime une carte par son ID |
| Delete (Single by Number) | DELETE /cards/delete/number/{cardNumber} | Numéro de carte valide | Non | N/A | Supprime une carte par son numéro |
| Delete (All) | DELETE /cards | N/A | Non | N/A | Supprime toutes les cartes |

# Exemples de corps de requête pour Card

**Create Card**
```json
{
  "customerId": 1,
  "cardNumber": "1234-5678-9012-3456",
  "cardType": "Visa",
  "totalLimit": 5000,
  "amountUsed": 1000,
  "availableAmount": 4000,
  "createDt": "2024-09-30"
}
```

**Update Card**
```json
{
  "cardNumber": "1111-2222-3333-4444",
  "cardType": "MasterCard",
  "totalLimit": 6000,
  "amountUsed": 2000,
  "availableAmount": 4000
}
```

# Contraintes d'intégrité supplémentaires

- **Intégrité référentielle** : La `customerId` dans la table `Card` doit correspondre à un client existant dans la table `Customer`.
- **Unicité** : Le numéro de carte (`cardNumber`) doit être unique pour chaque carte.
- **Validation des données** :
  - Les montants (`totalLimit`, `amountUsed`, `availableAmount`) doivent être positifs.
  - `availableAmount` doit être égal à `totalLimit` moins `amountUsed`.
- **Gestion des erreurs** :
  - Retourner 404 pour les ID ou numéros de carte invalides.
  - Retourner 400 pour les erreurs de validation.
- **Suppression en cascade** (optionnel) : Possibilité de supprimer un client et toutes ses cartes associées.
- **Suppression de tous les clients/cartes** : Ces opérations doivent être utilisées avec précaution et peuvent nécessiter une confirmation supplémentaire.





