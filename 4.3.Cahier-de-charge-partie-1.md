--------------------------------
# 1 - Rappel des deux classes **Customer** et **Card** avec les relations de clé primaire (PK) et clé étrangère (FK) :
--------------------------------


```
+--------------------------+             +--------------------------+
|        Customer           |             |          Card             |
+--------------------------+             +--------------------------+
| - customerId (PK)         | <-----------| - cardId (PK)             |
| - customerFirstName       |             | - customerId (FK)         |
| - customerLastName        |             | - cardNumber              |
+--------------------------+             | - cardType                |
                                          | - totalLimit              |
                                          | - amountUsed              |
                                          | - availableAmount         |
                                          | - createDt                |
                                          +--------------------------+
```

- **Customer** : La classe `Customer` contient `customerId` comme clé primaire (PK).
- **Card** : La classe `Card` contient `cardId` comme clé primaire (PK) et `customerId` comme clé étrangère (FK) qui fait référence à `Customer`.

- Relation entre un client et ses cartes, où un client peut avoir plusieurs cartes.


-------------------------------------------------
# 2 - Contraintes d'intégrité :
-------------------------------------------------


## Contrainte d'Intégrité pour les CRUDs avec Détails des Requêtes

| Fonctionnalité       | Entité     | Point de terminaison         | Contrainte                  | Requête (Corps) | Auto-incrément  | Description                                |
|----------------------|------------|------------------------------|-----------------------------|-----------------|-----------------|--------------------------------------------|
| **Create**           | Customer   | POST /customers/add           | N/A                         | Oui             | `customerId` auto-incrémenté, fournir prénom et nom |
|                      |            |                              |                             | **Corps JSON** :  | :white_check_mark:  | Exemple :                                 |
|                      |            |                              |                             | ```json        |                 |```json
{
  "customerFirstName": "John",
  "customerLastName": "Doe"
}
``` | 
|                      | Card       | POST /cards/add               | Client doit exister          | Oui             | `cardId` auto-incrémenté, fournir `customerId` (FK) et détails de la carte |
|                      |            |                              |                             | **Corps JSON** :  | :white_check_mark:  | Exemple :                                 |
|                      |            |                              |                             | ```json        |                 | ```json
{
  "customerId": 1,
  "cardNumber": "1234-5678-9012-3456",
  "cardType": "Visa",
  "totalLimit": 5000,
  "amountUsed": 1000,
  "availableAmount": 4000,
  "createDt": "2024-09-30"
}
``` | 
| **Read**             | Customer   | GET /customers/{id}           | ID valide                   | N/A             | N/A             | 404 si client inexistant                   |
|                      | Card       | GET /cards/{id}               | ID valide                   | N/A             | N/A             | 404 si carte inexistante                  |
| **Update**           | Customer   | PUT /customers/update/{id}    | ID valide                   | Oui             | Modifier le prénom/nom | 404 si client inexistant                   |
|                      |            |                              |                             | **Corps JSON** :  | :white_check_mark:  | Exemple :                                 |
|                      |            |                              |                             | ```json        |                 | ```json
{
  "customerFirstName": "Jane",
  "customerLastName": "Smith"
}
``` | 
|                      | Card       | PUT /cards/update/{id}        | Client doit exister          | Oui             | Modifier les détails de la carte | 404 si client ou carte inexistant          |
|                      |            |                              |                             | **Corps JSON** :  | :white_check_mark:  | Exemple :                                 |
|                      |            |                              |                             | ```json        |                 | ```json
{
  "cardNumber": "1111-2222-3333-4444",
  "cardType": "MasterCard",
  "totalLimit": 6000,
  "amountUsed": 2000,
  "availableAmount": 4000
}
``` | 
| **Delete**           | Customer   | DELETE /customers/delete/{id} | Client avec cartes          | N/A             | N/A             | Ne peut pas supprimer un client avec cartes|
|                      | Customer   | DELETE /customers/delete/{id} | Suppression en cascade       | N/A             | N/A             | Supprimer client avec ses cartes (option)  |
|                      | Card       | DELETE /cards/delete/{id}     | N/A                         | N/A             | N/A             | Supprime une carte                        |
| **Intégrité Référentielle** | Card | N/A                          | Clé étrangère               | N/A             | N/A             | Client lié à la carte                     |
| **Unicité**          | Card       | N/A                          | Numéro de carte unique       | N/A             | N/A             | Le numéro de carte est unique              |
| **Validation des Données** | Card | N/A                          | Valeurs positives            | N/A             | N/A             | Limite, montant utilisé et disponible > 0  |
|                      | Card       | N/A                          | Cohérence des montants       | N/A             | N/A             | Montant disponible = Limite - Montant utilisé |
| **Erreurs**          | Card/Customer| N/A                        | Gestion des erreurs          | N/A             | N/A             | 404 pour ID invalide, 400 pour validation  |
```

### Détails des colonnes :
1. **Fonctionnalité** : L'opération CRUD (Create, Read, Update, Delete).
2. **Entité** : Indique s'il s'agit de l'entité **Customer** ou **Card**.
3. **Point de terminaison** : L'URL du point d'accès API.
4. **Contrainte** : Les règles d'intégrité pour chaque opération (client doit exister, carte unique, etc.).
5. **Requête (Corps)** : Si l'opération nécessite un corps JSON, avec des exemples concrets pour les étudiants.
6. **Auto-incrément** : Indique si l'ID est auto-incrémenté.
7. **Description** : Explication plus détaillée de ce que fait chaque opération.

Cette version explique **très clairement** ce que tes étudiants doivent faire, avec des exemples concrets de ce à quoi doivent ressembler les requêtes JSON, en précisant également si un champ est auto-incrémenté, ce qui évite de les confondre.

