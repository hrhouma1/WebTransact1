--------------------------------
# 1 - Rappel des deux classes **Customer** et **Card** avec les relations de clé primaire (PK) et clé étrangère (FK) :
--------------------------------


```
+--------------------------+             +--------------------------+
|        Customer           |             |          Card             |
+--------------------------+             +--------------------------+
| - customerId (PK)         | <-----------| - cardId (PK)             |
| - customerFirstName       |             | - customerId (FK)         |
| - customerLastName        |             | - cardNumber              |
+--------------------------+             | - cardType                |
                                          | - totalLimit              |
                                          | - amountUsed              |
                                          | - availableAmount         |
                                          | - createDt                |
                                          +--------------------------+
```

- **Customer** : La classe `Customer` contient `customerId` comme clé primaire (PK).
- **Card** : La classe `Card` contient `cardId` comme clé primaire (PK) et `customerId` comme clé étrangère (FK) qui fait référence à `Customer`.

- Relation entre un client et ses cartes, où un client peut avoir plusieurs cartes.


-------------------------------------------------
# 2 - Contraintes d'intégrité :
-------------------------------------------------


## Contraintes d'intégrité pour les opérations CRUD

| Opération | Entité | Point de terminaison | Contrainte | Corps de requête | Auto-incrément | Description |
|-----------|--------|----------------------|------------|------------------|----------------|-------------|
| Create | Customer | POST /customers/add | N/A | Oui | ✓ | Ajoute un nouveau client |
| | Card | POST /cards/add | Client existant | Oui | ✓ | Ajoute une nouvelle carte |
| Read | Customer | GET /customers/{id} | ID valide | Non | N/A | Récupère les détails d'un client |
| | Card | GET /cards/{id} | ID valide | Non | N/A | Récupère les détails d'une carte |
| Update | Customer | PUT /customers/update/{id} | ID valide | Oui | N/A | Met à jour les informations d'un client |
| | Card | PUT /cards/update/{id} | ID valide, client existant | Oui | N/A | Met à jour les détails d'une carte |
| Delete | Customer | DELETE /customers/delete/{id} | Pas de cartes associées | Non | N/A | Supprime un client sans cartes |
| | Card | DELETE /cards/delete/{id} | N/A | Non | N/A | Supprime une carte |

## Exemples de corps de requête

### Create Customer
```json
{
  "customerFirstName": "John",
  "customerLastName": "Doe"
}
```

### Create Card
```json
{
  "customerId": 1,
  "cardNumber": "1234-5678-9012-3456",
  "cardType": "Visa",
  "totalLimit": 5000,
  "amountUsed": 1000,
  "availableAmount": 4000,
  "createDt": "2024-09-30"
}
```

### Update Customer
```json
{
  "customerFirstName": "Jane",
  "customerLastName": "Smith"
}
```

### Update Card
```json
{
  "cardNumber": "1111-2222-3333-4444",
  "cardType": "MasterCard",
  "totalLimit": 6000,
  "amountUsed": 2000,
  "availableAmount": 4000
}
```

## Contraintes d'intégrité supplémentaires

- **Intégrité référentielle** : La `customerId` dans la table `Card` doit correspondre à un client existant dans la table `Customer`.
- **Unicité** : Le numéro de carte (`cardNumber`) doit être unique pour chaque carte.
- **Validation des données** :
  - Les montants (`totalLimit`, `amountUsed`, `availableAmount`) doivent être positifs.
  - `availableAmount` doit être égal à `totalLimit` moins `amountUsed`.
- **Gestion des erreurs** :
  - Retourner 404 pour les ID invalides.
  - Retourner 400 pour les erreurs de validation.
- **Suppression en cascade** (optionnel) : Possibilité de supprimer un client et toutes ses cartes associées.

